{"name": "新建扫描任务", "status": "failed", "statusDetails": {"message": "AssertionError: 删除扫描任务异常: Locator.click: Timeout 30000ms exceeded.\nCall log:\n  - waiting for locator(\"xpath=(//span[contains(text(),'删除')])[3]/..\")\n  -     - locator resolved to <a data-v-5b3eb3b4=\"\" data-v-417877a3=\"\" data-v-67a880d0=\"\" icon=\"iconfont icon-shanchu\" class=\"el-link el-link--danger link-btn \">…</a>\n  -   - attempting click action\n  -     2 × waiting for element to be visible, enabled and stable\n  -       - element is not visible\n  -     - retrying click action\n  -     - waiting 20ms\n  -     2 × waiting for element to be visible, enabled and stable\n  -       - element is not visible\n  -     - retrying click action\n  -       - waiting 100ms\n  -     55 × waiting for element to be visible, enabled and stable\n  -        - element is not visible\n  -      - retrying click action\n  -        - waiting 500ms", "trace": ">   StepExecutor.execute_step(\"步骤4、删除扫描任务\", lambda: artifact_scan_task_creator.delete_artifact_scan_task(test_data), '删除扫描任务异常', controller)\n\nui\\test_cases\\test_case_artifact_scan_task.py:19: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nui\\page\\artifact_scan_task_creator.py:43: in delete_artifact_scan_task\n    self.artifact_scan_task_page.delete_task()\nui\\page\\artifact_scan_task_page.py:94: in delete_task\n    task_operation.delete_task(DELETE_SCAN_TASK, DELETE_CONFIRM_BUTTON)\nutils\\elements.py:194: in delete_task\n    self.controller.click(delete_button_xpath)\nutils\\sync_playwright_browser_controller.py:139: in click\n    self._get_element(selector, timeout).click()\nC:\\Users\\MJ\\AppData\\Roaming\\Python\\Python311\\site-packages\\playwright\\sync_api\\_generated.py:15450: in click\n    self._sync(\nC:\\Users\\MJ\\AppData\\Roaming\\Python\\Python311\\site-packages\\playwright\\_impl\\_locator.py:156: in click\n    return await self._frame.click(self._selector, strict=True, **params)\nC:\\Users\\MJ\\AppData\\Roaming\\Python\\Python311\\site-packages\\playwright\\_impl\\_frame.py:488: in click\n    await self._channel.send(\"click\", locals_to_params(locals()))\nC:\\Users\\MJ\\AppData\\Roaming\\Python\\Python311\\site-packages\\playwright\\_impl\\_connection.py:61: in send\n    return await self._connection.wrap_api_call(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <playwright._impl._connection.Connection object at 0x0000024BFFE3C850>, cb = <function Channel.send.<locals>.<lambda> at 0x0000024B8E40CEA0>, is_internal = False\n\n    async def wrap_api_call(\n        self, cb: Callable[[], Any], is_internal: bool = False\n    ) -> Any:\n        if self._api_zone.get():\n            return await cb()\n        task = asyncio.current_task(self._loop)\n        st: List[inspect.FrameInfo] = getattr(task, \"__pw_stack__\", inspect.stack())\n        parsed_st = _extract_stack_trace_information_from_stack(st, is_internal)\n        self._api_zone.set(parsed_st)\n        try:\n            return await cb()\n        except Exception as error:\n>           raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\nE           playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.\nE           Call log:\nE             - waiting for locator(\"xpath=(//span[contains(text(),'删除')])[3]/..\")\nE             -     - locator resolved to <a data-v-5b3eb3b4=\"\" data-v-417877a3=\"\" data-v-67a880d0=\"\" icon=\"iconfont icon-shanchu\" class=\"el-link el-link--danger link-btn \">…</a>\nE             -   - attempting click action\nE             -     2 × waiting for element to be visible, enabled and stable\nE             -       - element is not visible\nE             -     - retrying click action\nE             -     - waiting 20ms\nE             -     2 × waiting for element to be visible, enabled and stable\nE             -       - element is not visible\nE             -     - retrying click action\nE             -       - waiting 100ms\nE             -     55 × waiting for element to be visible, enabled and stable\nE             -        - element is not visible\nE             -      - retrying click action\nE             -        - waiting 500ms\n\nC:\\Users\\MJ\\AppData\\Roaming\\Python\\Python311\\site-packages\\playwright\\_impl\\_connection.py:528: TimeoutError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_case_artifact_scan_task.TestCaseArtifactScanTask object at 0x0000024BFFE68290>\ncontroller = <utils.sync_playwright_browser_controller.BrowserController object at 0x0000024B8E3F6ED0>\nartifact_scan_task_creator = <ui.page.artifact_scan_task_creator.ArtifactScanTaskCreator object at 0x0000024B8E32E110>\ntest_data = {'artifact_type': 'docker', 'is_del': True, 'node': 'nexus', 'plan_name': '', ...}\n\n    @allure.story(\"扫描任务\")\n    @pytest.mark.artifact_scan_task\n    def test_case_artifact_scan_task(self, controller, artifact_scan_task_creator, test_data):\n        \"\"\"测试创建扫描方案\"\"\"\n        allure.dynamic.title(f\"新建扫描任务\")\n        StepExecutor.execute_step('步骤1、登录devops', lambda: artifact_scan_task_creator.login_to_devops(),'登录devops异常', controller)\n        StepExecutor.execute_step(f\"步骤2、导航到制品扫描 - {test_data['tab']}\", lambda: artifact_scan_task_creator.navigate_to_scan_section(test_data), '导航到代码扫描页面异常', controller)\n        StepExecutor.execute_step(\"步骤3、创建扫描任务\", lambda: artifact_scan_task_creator.create_artifact_scan_task(test_data), '创建扫描任务异常', controller)\n>       StepExecutor.execute_step(\"步骤4、删除扫描任务\", lambda: artifact_scan_task_creator.delete_artifact_scan_task(test_data), '删除扫描任务异常', controller)\n\nui\\test_cases\\test_case_artifact_scan_task.py:19: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nstep_name = '步骤4、删除扫描任务', action = <function TestCaseArtifactScanTask.test_case_artifact_scan_task.<locals>.<lambda> at 0x0000024B8E40D1C0>, error_message = '删除扫描任务异常'\ncontroller = <utils.sync_playwright_browser_controller.BrowserController object at 0x0000024B8E3F6ED0>, capture_on_success = True\n\n    @staticmethod\n    def execute_step(step_name, action, error_message, controller, capture_on_success=True):\n        \"\"\"\n        执行测试步骤的通用方法\n        :param step_name: 步骤名称（用于Allure报告）\n        :param action: 要执行的操作（lambda或函数）\n        :param error_message: 错误提示信息\n        :param controller: 浏览器控制器（用于截图）\n        :param capture_on_success: 是否在出错时截图\n        \"\"\"\n        with allure.step(step_name):\n            try:\n                action()\n                # 可选：成功时截图\n                if capture_on_success:\n                    controller.capture(step=f\"{step_name} - 成功\")\n            except Exception as e:\n                logger.error(f\"{error_message}: {e}\", exc_info=True)\n                controller.capture(step=f\"{step_name} - 失败\")\n>               raise AssertionError(f\"{error_message}: {str(e)}\")\nE               AssertionError: 删除扫描任务异常: Locator.click: Timeout 30000ms exceeded.\nE               Call log:\nE                 - waiting for locator(\"xpath=(//span[contains(text(),'删除')])[3]/..\")\nE                 -     - locator resolved to <a data-v-5b3eb3b4=\"\" data-v-417877a3=\"\" data-v-67a880d0=\"\" icon=\"iconfont icon-shanchu\" class=\"el-link el-link--danger link-btn \">…</a>\nE                 -   - attempting click action\nE                 -     2 × waiting for element to be visible, enabled and stable\nE                 -       - element is not visible\nE                 -     - retrying click action\nE                 -     - waiting 20ms\nE                 -     2 × waiting for element to be visible, enabled and stable\nE                 -       - element is not visible\nE                 -     - retrying click action\nE                 -       - waiting 100ms\nE                 -     55 × waiting for element to be visible, enabled and stable\nE                 -        - element is not visible\nE                 -      - retrying click action\nE                 -        - waiting 500ms\n\nutils\\step_utils.py:27: AssertionError"}, "description": "测试创建扫描方案", "steps": [{"name": "步骤1、登录devops", "status": "passed", "attachments": [{"name": "步骤1、登录devops - 成功", "source": "0231a80e-8d17-4419-b7ff-32fb142a0702-attachment.png", "type": "image/png"}], "start": 1759057245623, "stop": 1759057257401}, {"name": "步骤2、导航到制品扫描 - 扫描任务", "status": "passed", "attachments": [{"name": "步骤2、导航到制品扫描 - 扫描任务 - 成功", "source": "58cdcba2-e5d7-4753-9fb6-d24857375019-attachment.png", "type": "image/png"}], "start": 1759057257401, "stop": 1759057262691}, {"name": "步骤3、创建扫描任务", "status": "passed", "attachments": [{"name": "步骤3、创建扫描任务 - 成功", "source": "5b42d3d2-2dc8-465d-9a64-2d565c34a8a8-attachment.png", "type": "image/png"}], "start": 1759057262691, "stop": 1759057271248}, {"name": "步骤4、删除扫描任务", "status": "failed", "statusDetails": {"message": "AssertionError: 删除扫描任务异常: Locator.click: Timeout 30000ms exceeded.\nCall log:\n  - waiting for locator(\"xpath=(//span[contains(text(),'删除')])[3]/..\")\n  -     - locator resolved to <a data-v-5b3eb3b4=\"\" data-v-417877a3=\"\" data-v-67a880d0=\"\" icon=\"iconfont icon-shanchu\" class=\"el-link el-link--danger link-btn \">…</a>\n  -   - attempting click action\n  -     2 × waiting for element to be visible, enabled and stable\n  -       - element is not visible\n  -     - retrying click action\n  -     - waiting 20ms\n  -     2 × waiting for element to be visible, enabled and stable\n  -       - element is not visible\n  -     - retrying click action\n  -       - waiting 100ms\n  -     55 × waiting for element to be visible, enabled and stable\n  -        - element is not visible\n  -      - retrying click action\n  -        - waiting 500ms\n\n", "trace": "  File \"D:\\Pycharm\\PythonProjects\\Playwright\\utils\\step_utils.py\", line 27, in execute_step\n    raise AssertionError(f\"{error_message}: {str(e)}\")\n"}, "attachments": [{"name": "步骤4、删除扫描任务 - 失败", "source": "de08ee60-0ffa-45a2-a974-5e384cb5c3b2-attachment.png", "type": "image/png"}], "start": 1759057271249, "stop": 1759057302667}], "attachments": [{"name": "log", "source": "5b9072f9-1ebe-4dd1-8be8-bfa19c814f42-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "test_data", "value": "{'tab': '扫描任务', 'node': 'nexus', 'plan_name': '', 'task_name': '制品扫描任务-', 'artifact_type': 'docker', 'quality_gates': {'serious': '10', 'high_risk': '20', 'moderate_risk': '30', 'low_risk': '40', 'unrated': '50'}, 'task_type': '仅保存', 'is_del': True}"}], "start": 1759057245622, "stop": 1759057302669, "uuid": "854da1b2-7b65-4fab-b43c-00732f9a5ee0", "historyId": "26bfdf4eff9ea6af4a9536d4b547f3dc", "testCaseId": "a53ef9cb8f808475877ba96dcc239dbf", "fullName": "ui.test_cases.test_case_artifact_scan_task.TestCaseArtifactScanTask#test_case_artifact_scan_task", "labels": [{"name": "story", "value": "扫描任务"}, {"name": "feature", "value": "制品扫描任务管理"}, {"name": "tag", "value": "artifact_scan_task"}, {"name": "parentSuite", "value": "ui.test_cases"}, {"name": "suite", "value": "test_case_artifact_scan_task"}, {"name": "subSuite", "value": "TestCaseArtifactScanTask"}, {"name": "host", "value": "LAPTOP-RB42MH0U"}, {"name": "thread", "value": "30752-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "ui.test_cases.test_case_artifact_scan_task"}]}